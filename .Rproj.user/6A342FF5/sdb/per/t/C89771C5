{
    "collab_server" : "",
    "contents" : "## Griffiths et al code Mary O'Connor\n## June 29 2017\n\n\n### load packages\n\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(reshape2)\nlibrary(plyr)\nlibrary(stringr)\n\n\n### load data\nsmith.bio <- read_csv(\"./data/Smith.csv\")\ncompare <- read.csv(\"./data/choked_seagrass_smithora.csv\")\nang <- read.csv(\"./data/macrophyte.biomass.zeros.csv\")\nsites <- read.csv(\"./data/choked_sites.csv\")\n\n### compare\n## from meadow surveys, identify edge and inner samples\nedge <- filter(compare, site == \"choked_edge_wolf\")\ninner <- filter(compare, site == \"choked_inner_wolf\")\ncompare_edge <- bind_rows(inner,edge)\n\n###Making data nicer for plotting\nhead(compare)\nView(compare)\ncompare_edge2 <- compare_edge\ncompare_edge2$site <- as.character(compare_edge2$site)\ncompare_edge2$site[compare_edge$site == \"choked_edge_wolf\"] <- \"Edge\"\ncompare_edge2$site <- as.character(compare_edge2$site)\ncompare_edge2$site[compare_edge$site == \"choked_inner_wolf\"] <- \"Interior\"\n\n### ANG  - These are ang's survey data. We still have a few questions about how to align epiphyte and shoot biomass. This current code, which I think is right, produces highlights that there are a few (~ 10) samples with epiphyte data but no Zostera data. So we are trying to understand this, and in the mean time will proceed with monitoring data (below). [7/5/2017]\n\nang2 <- merge(ang, sites, by.x = \"site\", by.y = \"name2\")\n## this next bit selects the sites we want, and removes a couple of rows that appeared to be duplicates, zeros, or unclearly assigned to a shoot. \nang <- ang2 %>%\n  filter(group != \"kelp\") %>%\n  select(-c(notes, oven_date, QAQC_date,QAQC_Initials, Lat, Long, foil_wgt_g, wet_wgt_g, dry_wgt_g)) %>%\n  mutate(uniqueID = paste(date, site, blade_sample_id, sep = \".\")) %>%\n  filter(final_dry_g != \"0\") %>%\n  filter(final_dry_g > \"0\") %>%\n  filter(uniqueID != \"29-May.inner sandspit.75\") %>%\n  mutate(uniqueID2 = paste(uniqueID, final_dry_g, sep = \".\")) %>%\n  filter(uniqueID2 != \"29-May.alcove.38.0.1\") %>%\n  select(-uniqueID2)\n  \nang3 <- ang %>%  \n  spread(macrophyte, final_dry_g) %>% \n  group_by(uniqueID) %>%\n  \nang4 <- ang3 %>%\n  summarise_each(funs(first))\n\n#### Monitoring data\n## started with our data, but there isn't an inner site here, really...\n\nshoots2015 <- read.csv(\"./data/biodiversitysurvey.2015.eelgrass.single.shoots.monitoring.csv\")\nshoots2015$site_id <- revalue(shoots2015$site, c(\"goose_east\"=\"GsE\", \"goose_west\"=\"GsW\", \"mcmullins_north\" = \"MMn\", \"mcmullins_south\" = \"MMs\", \"triquet_south\" = \"TqS\", \"triquet_north\"= \"TqN\", \"choked_south_pigu\" = \"Cspg\", \"choked_sandspit\" = \"Csan\"))\nView(shoots2015)\n\nshoots <- shoots2015 %>%\n  filter(site_id %in% c(\"Csan\", \"Cspg\")) %>%\n  replace(is.na(.), 0) %>%\n  mutate(sm.zm = smithora/total.dry.weight)\n\nsm.zm <- ggplot(shoots, aes(x = site_id, y = sm.zm)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Smithora / Zostera shoot weight (g/g dry wt)\", limits = c(0, 2)) +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) + \n  geom_text(label = \"A\", x = 2.4, y = 15) +\n  theme(axis.title.x = element_text(vjust = -1, size = 12)) + \n  theme(axis.title.y = element_text(vjust = -1, size = 12))\nsm.zm\n\n## FIGURE 2: ZOSTERA AND SMITHORA ABUNDANCE at transplant sites before experiment\n\n## A) Shoot density\nshoot.density <- ggplot(compare_edge2, aes(x = site, y = number.shoots.quadrat)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Zostera Shoots (N/0.0625 m^2)\", labels=c(\"0\",\"5\",\"10\",\"15\"), limits = c(0, 15)) +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) + \n  geom_text(label = \"A\", x = 2.4, y = 15) +\n  theme(axis.title.x = element_text(vjust = -1, size = 12)) + \n  theme(axis.title.y = element_text(vjust = -1, size = 12))\n\nggsave(\"shoot.density.jpg\", plot = shoot.density, width = 3, height = 3)\n\n## B) Zostera above ground biomass (dry weight)\nshoot.dwt <- ggplot(compare_edge2, aes(x = site, y = total.dry.macro.weight)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Zostera shoot dry weight (g)\", labels=c(\"0\",\"10\",\"20\", \"30\"), limits = c(0, 30)) +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) + \n  geom_text(label = \"B\", x = 2.4, y = 30) +\n  theme(axis.title.x = element_text(vjust = -1, size = 12)) + \n  theme(axis.title.y = element_text(vjust = -1, size = 12))\n\nggsave(\"shoot.dwt.jpg\", plot = shoot.dwt, width = 3, height = 3)\n\n\n## C) Zostera above ground biomass (dry weight)\nsmithora <- ggplot(compare_edge2, aes(x = site, y = macroepiphyte.weight/total.dry.macro.weight)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  scale_y_continuous(name = \"Smithora weight (g / dry g SG)\", limits = c(0, 0.5)) +\n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  xlab(expression(\"Location\")) + \n  geom_text(label = \"C\", x = 2.4, y = 0.5) +\n  theme(axis.title.x = element_text(vjust = -1, size = 12)) + \n  theme(axis.title.y = element_text(vjust = -1, size = 12))\n\nggsave(\"smithora.jpg\", plot = smithora, width = 3, height = 3)\n\n## FIGURE 3: Smithora results post experiment - remake this figure.\nhead(smith.bio)\nsmith.bio$Source <- revalue(smith.bio$Source, c(\"edge\"=\"Edge (high Smithora)\",  \"inner\"=\"Interior (low Smithora)\"))\nsmith.bio$Type <- revalue(smith.bio$Type, c(\"ambient\"=\"Unmanip.\", \"experiment\"=\"Transplanted\", \"control\"=\"Control\"))     \n\nexperiment <- ggplot(smith.bio, aes(x = Type, y = biomass)) + \n  geom_point(size = 6, colour = \"gray\") +\n  geom_boxplot(size = 1, fill = \"transparent\") + \n  facet_wrap(~Source) + \n  theme_bw() + \n  theme(panel.grid = element_blank()) + \n  theme(strip.background = element_rect(fill=\"white\")) + \n  scale_y_continuous(name = expression(paste(italic(\"Smithora\"), \" (g dry wt / g Zostera dry wt)\")), limits = c(0, 1)) +\n  xlab(\"Shoot Treatment\") +\n  #scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +\n  labs(title = \"Site of Experimental Planting\") + \n\nexperiment\nggsave(\"experiment.jpg\", plot = experiment, width = 6, height = 3)\n\n## Experimental analysis: \nhist(smith.bio$biomass)\nhist(log(smith.bio$biomass))\n\nmod1 <- lm(smith.bio$biomass ~ smith.bio$Type, family = poisson)\n\n### Figure 5: Experimental results\n\n\n",
    "created" : 1498776115289.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "156926598",
    "id" : "C89771C5",
    "lastKnownWriteTime" : 1499352512,
    "last_content_update" : 1499352512645,
    "path" : "~/Documents/projects/Biodiversity/Biodiversity BC/eelgrass biodiversity BC/Griffiths et al/analysis/Griffiths et al master code.R",
    "project_path" : "analysis/Griffiths et al master code.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}